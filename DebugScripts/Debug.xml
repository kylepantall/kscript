<!-- 
    KScript treats any node without child elements as a single node. 
    This means a "dowhile" without any elements isn't handled.
    In order for any KScript Object node containers to handle nodes they must 
    contain elements so the parser can treat them as a collection of nodes 
    and pass them to the appropriate Operator handler.
-->

<kscript dynamic_defs="yes" throw_exceptions="yes" quiet="no" print_info="no">
    <!-- <def id="name">James</def>
    <wait interval="1s" />
    <update to="name">Chloe</update>

    <def id="datetime">@datetime()</def>

    <for to="i" while="@more_less($i,'lt',10)" math="$i->increment()">
        <update to="name">$i</update>
    </for>

    <echo>$datetime \n</echo>

    

    <echo>@defstate('name') \n</echo>

    <echo>@defstate('name', $datetime)</echo> -->

    <echo>@datetime()\n</echo>
    <def id="date">@to_date(@datetime(), 'D1H3S13Y10MO13')</def>

    <echo>$date\n</echo>

    <echo>@to_date($date, 'H3')\n</echo>

    <echo>@defstate('date')</echo>

    <watcher handle_method="once">
        <watchers>
            <!-- <watch for="name" /> -->
            <watch for="date" />
        </watchers>

        <rules>
            <rule condition="@empty($date)">
                <echo>You must enter a name</echo>
            </rule>

            <rule condition="@more_less($date,gt,10)">
                <echo>Name can't be more than 10</echo>
            </rule>
        </rules>
    </watcher>

    <update to="date">Chloe</update>
</kscript>